# 開発ガイド

## ホットリロードセットアップ

このプロジェクトには、ブラウザ拡張機能開発のための適切なホットリロードが含まれるようになりました。

### クイックスタート

1. **開発モードを開始：**
   ```bash
   npm run dev
   ```

2. **Chromeに拡張機能をロード：**
   - Chromeを開き、`chrome://extensions/`に移動
   - 「デベロッパーモード」を有効にする（右上のトグル）
   - 「パッケージ化されていない拡張機能を読み込む」をクリックし、このプロジェクトの`dist`フォルダーを選択
   - これで拡張機能がロードされ、使用する準備が整いました

3. **変更を加える：**
   - `src/`ディレクトリ内の任意のファイルを編集
   - ファイルを保存
   - Viteが自動的に拡張機能を再ビルド
   - `chrome://extensions/`の拡張機能カードの更新アイコンをクリック
   - 変更が表示されます！

### 利用可能なスクリプト

- `npm run dev` - ファイル監視と自動再ビルドを使用した開発モードを開始
- `npm run build` - 本番用に拡張機能をビルド
- `npm run dev:serve` - Vite devサーバーを開始（ウェブ開発用、拡張機能用ではありません）
- `npm run copy-static` - public/からdist/に静的ファイルをコピー

### 仕組み

開発セットアップ：

1. **静的ファイルをコピー** `public/`から`dist/`へ（manifest.json、HTMLファイル、アイコン）
2. **TypeScriptファイルをコンパイル**
3. **Viteでビルド** ウォッチモードで、`dist/`に出力
4. **変更を監視** し、自動的に再ビルド

### ファイル構造

```
dist/                 # ビルドされた拡張機能ファイル（Chromeにこれをロード）
├── manifest.json     # 拡張機能マニフェスト
├── background.js     # バックグラウンドスクリプト
├── sidepanel.js      # サイドパネルスクリプト
├── options.js        # オプションページスクリプト
├── sidepanel.html    # サイドパネルHTML
├── options.html      # オプションページHTML
├── assets/           # CSSおよびその他のアセット
└── icons/            # 拡張機能アイコン
```

### トラブルシューティング

**変更が表示されない？**
1. 拡張機能カードの更新アイコンをクリックしたことを確認
2. ターミナルでビルドエラーをチェック
3. 拡張機能を完全にリロードしてみる（削除して再追加）

**ビルドエラー？**
1. ターミナルでTypeScriptコンパイルエラーをチェック
2. すべての依存関係がインストールされていることを確認：`npm install`
3. クリーンして再ビルドしてみる：`rm -rf dist && npm run dev`

### 拡張機能のリロード

ウェブアプリケーションとは異なり、ブラウザ拡張機能はコード変更後に手動でリロードする必要があります。ワークフローは次のとおりです：

1. コード変更を行う
2. ファイルを保存（Viteが自動的に再ビルド）
3. `chrome://extensions/`に移動
4. 拡張機能の更新アイコンをクリック
5. 変更をテスト

これは、ビルドがバックグラウンドで自動的に行われるため、従来のビルドとリロードのサイクルよりもはるかに高速です。
