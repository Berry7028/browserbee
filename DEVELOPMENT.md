# 開発ガイド

## ホットリローディングのセットアップ

このプロジェクトには、ブラウザ拡張機能開発のための適切なホットリローディングが含まれています。

### クイックスタート

1. **開発モードを開始:**
   ```bash
   npm run dev
   ```

2. **Chromeで拡張機能を読み込む:**
   - Chromeを開き、`chrome://extensions/` にアクセス
   - 「デベロッパーモード」を有効化（右上のトグル）
   - 「パッケージ化されていない拡張機能を読み込む」をクリックし、このプロジェクトの `dist` フォルダを選択
   - これで拡張機能が読み込まれ、使用準備が整います

3. **変更を行う:**
   - `src/` ディレクトリの任意のファイルを編集
   - ファイルを保存
   - Viteが自動的に拡張機能をリビルド
   - `chrome://extensions/` の拡張機能カードで更新アイコンをクリック
   - これで変更が表示されます！

### 利用可能なスクリプト

- `npm run dev` - ファイル監視と自動リビルドによる開発モードを開始
- `npm run build` - 本番用に拡張機能をビルド
- `npm run dev:serve` - Vite開発サーバーを開始（拡張機能ではなくウェブ開発用）
- `npm run copy-static` - public/ から dist/ に静的ファイルをコピー

### 仕組み

開発セットアップ:

1. **静的ファイルをコピー** - `public/` から `dist/` へ（manifest.json、HTMLファイル、アイコン）
2. **TypeScriptファイルをコンパイル**
3. **Viteで監視モードでビルド** - `dist/` に出力
4. **変更を監視** し、自動的にリビルド

### ファイル構造

```
dist/                 # ビルドされた拡張ファイル（Chromeで読み込む）
├── manifest.json     # 拡張機能マニフェスト
├── background.js     # バックグラウンドスクリプト
├── sidepanel.js      # サイドパネルスクリプト
├── options.js        # オプションページスクリプト
├── sidepanel.html    # サイドパネルHTML
├── options.html      # オプションページHTML
├── assets/           # CSSとその他のアセット
└── icons/            # 拡張機能アイコン
```

### トラブルシューティング

**変更が表示されない？**

1. 拡張機能カードの更新アイコンをクリックしたことを確認
2. ターミナルでビルドエラーを確認
3. 拡張機能を完全にリロードしてみる（削除して再追加）

**ビルドエラー？**

1. ターミナルでTypeScriptコンパイルエラーを確認
2. すべての依存関係がインストールされていることを確認: `npm install`
3. クリーンしてリビルド: `rm -rf dist && npm run dev`

### 拡張機能のリロード

ウェブアプリケーションとは異なり、ブラウザ拡張機能はコード変更後に手動でのリロードが必要です。ワークフロー:

1. コード変更を行う
2. ファイルを保存（Viteが自動的にリビルド）
3. `chrome://extensions/` にアクセス
4. 拡張機能の更新アイコンをクリック
5. 変更をテスト

これは従来のビルド-リロードサイクルよりもはるかに高速で、ビルドがバックグラウンドで自動的に行われるためです。
